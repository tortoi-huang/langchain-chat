电讯盈科-JAVA编码规范

版本：

日期：2022-12-1

文档修改记录

|  |  |  |  |
| --- | --- | --- | --- |
| **版本号** | **修订日期** | **修改内容** | **作者** |
| V1.0 | 2022-12-1 | 起草，修订 | 寇⽂君 |
|  |  |  |  |
|  |  |  |  |
|  |  |  |  |
|  |  |  |  |
|  |  |  |  |
|  |  |  |  |

**目 录**

[1 引言 1](#_Toc393449123)

[1.1 目的 1](#_Toc393449124)

[1.2 适用范围 1](#_Toc393449125)

[1.3 概念和术语 1](#_Toc393449126)

[2 命名规范 1](#_Toc393449127)

[2.1 总则 1](#_Toc393449128)

[2.2 类、接口、包和其它可编译单元命名 2](#_Toc393449129)

[2.2.1 类的命名 2](#_Toc393449130)

[2.2.2 接口命名 2](#_Toc393449131)

[2.2.3 包的命名 2](#_Toc393449132)

[2.2.4 编译单元的命名 2](#_Toc393449133)

[2.3 成员函数命名 3](#_Toc393449134)

[2.4 字段命名 3](#_Toc393449135)

[2.5 常量的命名 3](#_Toc393449136)

[2.6 局部变量命名 4](#_Toc393449137)

[2.7 函数参数的命名 4](#_Toc393449138)

[2.8 测试类/函数的命名 4](#_Toc393449139)

[2.9 工程的路径和包（package）的使用 4](#_Toc393449140)

[3 注释规范 5](#_Toc393449141)

[3.1 使用注释符 5](#_Toc393449142)

[3.2 注释标签的使用 6](#_Toc393449143)

[3.3 需要注释的内容 6](#_Toc393449144)

[4 书写规范 10](#_Toc393449145)

[4.1 缩进与对齐 10](#_Toc393449146)

[4.2 疏密有秩 12](#_Toc393449147)

[4.3 长度控制 12](#_Toc393449148)

[4.4 运算顺序 13](#_Toc393449149)

[4.5 局部变量的声明位置 13](#_Toc393449150)

[4.6 类成员的声明顺序 13](#_Toc393449151)

[4.7 可见性策略 14](#_Toc393449152)

[4.8 常量的使用 14](#_Toc393449153)

[4.9 存取函数的使用 14](#_Toc393449154)

[5 附录：编程技巧 14](#_Toc393449155)

# 引言

## 目的

本规范的用于指导公司所有Java程序开发编码。

制定编码规范的首要考虑的目标是：提高代码的可读性。从而使现有的项目成员能够互相快速地读懂代码；使后加入的程序员很快熟悉已有代码；使维护人员容易、高效地维护代码。规范编码的同时要考虑的目标还有：代码质量、生产效率、调式效率、维护效率。但当可读性和编写效率在某些局部问题上冲突时，可读性优先。因为可读性是调式效率、维护效率的基础，是保证代码质量的前提。

## 适用范围

本规范适用于所有基于Java开发的项目。

## 概念和术语

1. 编译单元(unit)：可单独编译的代码块。
2. 块(block)：成对括号{}中的代码。
3. 包(package)
   1. 局部包(local package)：一个开发组织内部使用的包，不在开发组织之外分发和使用。
   2. 全局包(globe package)：分发给多个组织使用的包。
4. 类(class)
5. 接口(interface)
6. 常量(constant)
7. 局部变量(local variable)
8. 窗口部件(compomentt/widget)：窗口上的button,listbox等小部件。

# 命名规范

## 总则

总则适合于各种程序元素的命名。程序元素指类、变量、字段等。各种具体的程序元素的命名规范是总则的具体化和细化。

* 英文全拼。类、字段、成员函数、局部变量用准确的英文全拼。
* 大小写混用，便于断字。
* 长度适宜。最好小于15个字符，测试类/函数的命名例外。
* 起一致的名字。例如如果顾客统一为customer，就不能用client。
* 不起类似的名字。两种情况：避免同一类型的程序元素拼写相似；不同类型的程序元素重名。例如：fisrtName，fistName。

例如：在一个成员函数中，参数有customerName，字段有customerName，局部变量也有customerName。

## 类、接口、包和其它可编译单元命名

### 类的命名

英文全拼，大小写混用，所有字的首字母都大写，其余字母小写。

### 接口命名

英文全拼，接口命名以“I+形容词或被修饰了的名词”方式命名。例如IDataInput。

### 包的命名

包的名称用多个字构成，字之间用’.’间隔。

1. Java标准包的命名以java打头
2. 局部包

局部包只在一个组织内部使用，所以名称不需要包含公司标志。例如：

persistence.mapping.relational，interface.screen。

1. 全局包

局部包分发给多个组织使用，要保证与任何一个web上的包不重名，且包含公司标志。所以，一般使用‘公司的web地址的倒序.包的描述’。

公司的全局包的前缀是：com.chinamobile

### 编译单元的命名

与类同名，用.java作后缀。例如Customer.java。

基本命名方法为：用英文单词或其缩写形式的组合命名，文件名的首字母大写，每个单词第一字母大写，其余字母小写，单词间无任何分界符，如：Main，StartSplash，SetDate等。

## 成员函数命名

1. 动宾结构或动词，函数的目的很明确。

动词小写，其它词首字母大写。

例如： openAccount()

printMailingLabel()

delete()

save()

1. 存取函数setter和getter

存取函数getter和setter分别用于读取或设置字段的值。一般字段的存取函数名称的格式如下：

set+字段名

get+字段名

例如：setAccountNumber()、getCustomerID

bool型字段的存取函数的命名根据字段内容可用is作前缀，例如isClosed(),setClose()。

Constructor的命名必须与class同名。此规范由Sun规定，必须严格遵守。

## 字段命名

用英文全拼，表明字段内容。集合字段（数组、向量）用复数。

举例： orderItems

customers

discountRate

unitPrice

zipCode

## 常量的命名

Java中，常量一般定义尾static final字段。

用全英文大写，字间用下划线连接。

例如： DEFAULT\_VALID\_DATE

VERSION\_ID

## 局部变量命名

1. 与字段的命名规范相同，即首字小写，其余的字首字母大写。
2. Sun提出一套局部变量类型缩写，例如b—byte, s—string等，不建议使用。因为业务软件中，变量的类型比较明显，不在名称中体现不影响程序的易读性。
3. 另有三类变量的命名规范稍有不同，它们是：流变量(Streams)、循环控制变量(Loop counters)、异常(Exceptions)。
4. 如果一个函数中，只打开一个流变量，用于输入、输出或输入/输出，使用之后在函数中关闭，则分别用in、out和inOut作为流的名称。
5. 循环控制变量Loop counters的命名用建议使用与具体业务逻辑有关的单词，例如xxcount。
6. Exceptions的命名用e即可。

## 函数参数的命名

函数参数的命名约定与局部变量的相同。

为了避免参数与局部变量重名，函数参数常加前缀a或an。例如aCustomer，anOrder。变量与参数重名时虽然可以使用this.区分，但往往忘记加this，所以要避免重名。

## 测试类/函数的命名

使用Junit进行单元测试，按照Junit的命名方式。

## 工程的路径和包（package）的使用

按照国际通用的java包的设置方法，包名一般以com.companyname开始，比如com.chinamobile可以表示中国移动的包。包名与路径是一一对应的，包的命名全部用小写，其中不允许出现下划线（”\_”）。例如：

界面生成器的的路径为：

界面生成器（项目文件根目录）

+--src（源程序根路径）

| | | +--com

| | | +--chinamobile

| | | +--product

| | | +--access(访问)

| | | +--business (业务)

| | | +--control(控制)

| | | +--page(界面生成器)

| | | +--test(测试)

| | | +--user(用户管理)

| | | +--util（公用）

| | | +--web（Web层）

| | | +--Proxy（Web虚拟路径根路径，可以由Jbuilder生成）

| | | +--images（图片）

| | | +--errror（错误页面）

| | | +--conf（配置文件）

| | | +--WEB-INF

| | | +--tlds（自定义的标记）

| | | +--xml（xml格式的配置文件）

| | | +--lib（需要下载到浏览器端的库文件，一般是jar文件）

# 注释规范

## 使用注释符

三种注释符的名称及用途也及使用位置如下：

|  |  |  |  |
| --- | --- | --- | --- |
| **符号与格式** | **名称** | **用途** | **位置** |
| /\*\*  \*  \*  \*/ | 头注释 | 说明类、接口或函数。其内容可被Javadoc识别。 | 模块顶部，或函数说明行的上一行。与sun的规范不同，sun的格式破坏了函数代码的连续性。 |
| /\*  \*/ | 段注释 |  | 多行 |
| /\*……\*/ | 单行注释 | 也可以用// | 单行 |
| aMethod(); /\* …\*/ | 尾部注释 | 也可以用// | 代码尾部。 |
| //  //  // | 行注释 | 可以用来删除一段有保留价值的代码。 |  |

## 注释标签的使用

标签块在描述性文本之后，按以下顺序使用：

\* @author （仅对classes和 interfaces，按作者参与的时间顺序，创建者在前）

\* @version （仅对classes和 interfaces) (格式 %I%, %G%)

\* （空行，增加易读性）

\* @param （仅对methods和constructors, 对每个参数都说明，按参数的顺序）

\* @return （仅对methods)

\* @exception （多个exceptions时，按字母顺序）

\* @see （按字母顺序）

\* @since

\* @serial (or @serialField or @serialData)

\* @deprecated (see [How and When To Deprecate APIs](http://java.sun.com/products/jdk/1.1/docs/guide/misc/deprecation/deprecation.html))

## 需要注释的内容

1. 总则

如果注释能够增加代码的易读性，那么增加注释，反之，不必。多余或错误的注释只能使代码更晦涩。

注释不必修饰，例如加/\*\*\*\*\*\*\*\*\*\*/框，加框只能浪费时间，并不增加易读性。

1. 程序头注释

程序文件头：文件名

作者

创建日期

功能，用法

类名列表

copyright 信息，包括版权日期。

修改记录，包括已知的bug，未妥善解决的问题。

1. 类/函数头

* 完成什么操作
* 接收什么参数
* 返回什么结果
* 已知的bugs
* exception函数
* 可见性解释（需要解释的）
* 成员函数如何改变对象
* 使用此函数的例子（如果需要的话）
* 函数正确执行的前提条件和执行后的条件

1. 代码行的注释内容

* 控制结构需加注释，以便不读整个控制代码就可以了解控制结构做什么。
* 实现业务逻辑的代码加注释，说明代码做什么、为什么这么做。
* 局部变量要在声明时说明其用途。
* 复杂的代码段要加注释。
* 必须按顺序执行的代码需要注释。
* 多层嵌套的控制结构中，在每个结束符‘}’注释，例如//end if,//end for //end switch。

1. 字段注释

所有字段都应注释，注释应包含以下几方面内容：

* 说明其用途；
* 与值有关的永真条件，例如：日期必须有效，月在1-12之间，日在1-31之间；
* 用法举例；
* 可见性解释：如果不是private的，应说明为什么。

1. 包的头注释

说明包的内容、作用。提供包中类名列表。

举例：

/\*\*

\* Copyright 2008 China Mobile Research Institute. All Right Reserved

\*

\* This file is owned by China Mobile and you may not use, modify, copy,

\* redistribute this file without written permissions.

\*

\* These Terms of Use define legal use of this file, all updates, revisions,

\* substitutions for you. All rights not expressly granted to you are reserved

\* by Chinamobile.

\*/

package com.cmri.hugetable.index;

import com.cmri.hugetable.common.\*;

/\*\*

\* （*Class description goes here*.）

\* @version 1.82 18 Mar 2009

\* @author Qian, Ling

\*/

public class Blah extends SomeClass {

/\* A class implementation comment can go here. \*/

/\*\* classVar1 documentation comment \*/

public static int classVar1;

/\*\*

\* classVar2 documentation comment that happens to be

\* more than one line long

\*/

private static Object classVar2;

/\*\* instanceVar1 documentation comment \*/

public Object instanceVar1;

/\*\* instanceVar2 documentation comment \*/

protected int instanceVar2;

/\*\* instanceVar3 documentation comment \*/

private Object[] instanceVar3;

/\*\*

\* ...constructor Blah documentation comment...

\*/

public Blah() {

// ...implementation goes here...

}

/\*\*

\* ...method doSomething documentation comment...

\*/

public void doSomething() {

// ...implementation goes here...

}

/\*\*

\* ...method doSomethingElse documentation comment...

\* @param someParam description

\*/

public void doSomethingElse(Object someParam) {

// ...implementation goes here...

}

}

# 书写规范

## 缩进与对齐

1. 用4个空格缩进嵌套在内层的程序块。如使用Tab键，建议一个Tab键对应成4个空格。
2. 代码块对齐有两种格式可选择，但至少在一个编译单元中使用一致的格式。
3. 格式一：代码块的首尾括号‘{’、‘}’分别独占一行，均与块头行纵向左对齐。
4. 格式二：代码块的首括号紧跟块头，尾括号}独占一行，与块头左对齐。

推荐使用格式一，但不强制。

格式一举例(摘自swing.java)：

public class ComboBox1 extends JFrame

{

public ComboBox1()

{

super("ComboBoxes [Compare Cars]");

getContentPane().setLayout(new BorderLayout());

Car camry = new Car("Camry", "Toyota", new ImageIcon(

"camry.gif"));

camry.addTrim("LE V6", 21888, 19163, "3.0L V6 194-hp");

camry.addTrim("XLE V6", 24998, 21884, "3.0L V6 194-hp");

cars.addElement(camry);

WindowListener wndCloser = new WindowAdapter()

{

public void windowClosing(WindowEvent e)

{

System.exit(0);

}

};

addWindowListener(wndCloser);

pl.selectCar(maxima);

pr.selectCar(accord);

setResizable(false);

pack();

setVisible(true);

}

public static void main(String argv[])

{

new ComboBox1();

}

}

格式二举例（摘自<thinking in java>）：

public class Parcel6 {

public Contents cont() {

return new Contents() {

private int i = 11;

public int value() { return i; }

}; // Semicolon required in this case

}

public static void main(String[] args) {

Parcel6 p = new Parcel6();

Contents c = p.cont();

}

} ///:~

## 疏密有秩

1. 在第一层、第二层的代码块之间、较大的代码块之间加空行。使之段落清晰。
2. 用一个空格将运算符和操作数分隔开。圆括号和括号中的内容之间不用空格。循环控制变量可例外。

例如：

public AnimatedLabel(String gifName, int numGifs)

{

m\_icons = new Icon[numGifs];

for (int k=0; k<numGifs; k++)

m\_icons[k] = new ImageIcon(gifName+k+".gif");

setIcon(m\_icons[0]);

Thread tr = new Thread(this);

tr.setPriority(Thread.MAX\_PRIORITY);

tr.start();

}

## 长度控制

1. 遵守30秒原则--代码的清晰程度和大小保证其它程序员能够在30秒内读懂成员函数做什么，如何做。如果不能保证，或者代码太大需要分解，或者注释不清晰需要修改。一般地，一个成员函数的代码不应超过一屏。
2. 程序行宜短，控制在80字符以下；一行只做一件事情。例如：一行只声明一个变量。如果行尾注释太长，可以将注释加在程序行的上一行。如果一行程序太长，折行应遵守以下规则：
3. 在’,’之后折行；
4. 在运算符之前；
5. 尽量在更一级的运算层次上折行；
6. 折行的各行依次用两个tab键缩进；
7. 若在多个运算符之前折行，同一运算级别的运算符左对齐。
8. 每个可编译文件的代码长度应控制在2000行之内，这也是sun的建议。

## 运算顺序

用圆括号指出操作顺序。根据编程语言的缺省的运算规则，有些括号可不省略，但有些语句比较复杂，运算顺序不很明显，读者必须仔细判断或很清楚运算规则，例如and，or的混合运算。因此，为了提高程序的易读性，在包含多个运算符的语句中增加圆括号，使运算顺序很明显。

有时，圆括号用于强调运算顺序，其中隐含着对运算关系的理解。例如A+B+C，如果A+B有特殊意义，不仿写成(A+B)+C。

## 局部变量的声明位置

在JAVA中，局部变量可以随用随声明，也可以在成员函数的代码段之前集中声明。前者用起来比较方便，但很难控制程序的易读性，有可能声明语句和首次使用它的语句中间有一些其它代码，成员函数用到哪些变量也很难一下看出来。建议使用后者，这样程序易读性更好。无论使用哪种方式，一个人在一个项目的代码风格应该一致。

坚持一个局部变量只代表一个事物。循环变量可例外。

## 类成员的声明顺序

遵照以下顺序：

constructors

finalize()

public member functions

public fields

proctected member functions

protected fields

private member functions

private fields

每一小节中，先声明static类型的，再声明instance类型的，每类型中按字母顺序排序，或按功能类型分组，无论怎样，坚持一种方式。

## 可见性策略

1. 字段都定义为private，提供get，set函数，无一例外。
2. 不存到外存设备的字段用static或transient标明。这样做与BDK（beans development kits）的规范一致。
3. 存取函数的可见性根据需要设置，不要把所有字段的存取函数都公布为public。

## 存取函数的使用

以下是存取函数的用法：

1. 封装字段
2. 封装常量
3. 扩展的存取函数访问集合

集合的访问除了set，get函数，还有其特殊的访问函数用于插入、删除、创建对象。例如：insertCustomers（），deleteCustomers，createCustomers。

1. 同时读或写一组字段

有些字段同时存取才有意义，此时可以提供一个整体存取函数。例如，图形位置的存取，除getXPosition和getYPosition外，应提供public getPosition。

1. 后初始化(lazy intialization)字段。字段在用的时候调用set函数初始化。
2. 降低超类和子类间的偶合程度。子类只有通过存取函数读写从超类继承来的字段，解决了改变超类波及子类的问题。
3. 使并发写容易控制。‘写’操作只有一个入口，是并发控制更容易实现。

# 附录：编程技巧

1. 先注释后代码。写一段程序之前先写注释，有助于理清思路，提高编码效率和代码质量。
2. 实现类时，先定义public，protected interface，后实现。
3. 尽量少的public函数和protected函数，原因：
4. 可以提高类的易用性。使用者只需要了解少量的public 和 private函数即可。
5. 最大限度地封装了类，减低了偶合度。
6. 增加了灵活性。类内部修改不影响使用它的类和从它继承来的类。
7. 写测试程序，经常测试。
8. 从数据库查询到集合和实体对象时，应当做非null判断。
9. 在打开文件流时，在流存取结束后，应当及时关闭。
10. 对于软件程序抛出的异常信息，应当及时捕获，并将业务错误返回给前端，不可将堆栈报错信息返回到前端页面。