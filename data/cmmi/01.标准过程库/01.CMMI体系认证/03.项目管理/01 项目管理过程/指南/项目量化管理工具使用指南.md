CMMI高成熟度工具使用指南

版本 V1.0

# 水晶球Crystal Ball使用指南

![SpxImage5](data:image/png;base64...) 工具安装路径在配置库：CMMI\CMMI5\13 工具 目录下

# 蒙托卡罗练习

三角分布预测：在没有基线数据的情况下，用来预测结果。（根据专家给出的最短、最可能、最长三组数据）

备注：蒙托卡罗模拟帮助识别风险

|  |  |  |  |
| --- | --- | --- | --- |
| ***过程*** | ***工期*** | | |
| ***步骤*** | ***最短工期*** | ***最可能工期*** | ***最长工期*** |
| ***需求调研*** | ***27*** | ***30*** | ***75*** |
| ***需求分析*** | ***45*** | ***50*** | ***125*** |
| ***概要设计*** | ***72*** | ***80*** | ***200*** |
| ***详细设计*** | ***45*** | ***50*** | ***125*** |
| ***编码*** | ***81*** | ***90*** | ***225*** |
| ***单元测试*** | ***23*** | ***25*** | ***63*** |
| ***集成测试*** | ***32*** | ***35*** | ***88*** |
| ***系统测试*** | ***41*** | ***45*** | ***113*** |
| ***试运行*** | ***63*** | ***70*** | ***175*** |
| ***验收测试*** | ***23*** | ***25*** | ***63*** |
|  |  | ***500*** |  |

步骤1.打开水晶球，将数据填入表格

点击数据右侧的单元格（D2），选择左上角绿色图形图标Define Assumption，选择三角分布Triangular。接下来每一行都执行上述操作。

![](data:image/png;base64...)

步骤2.上一步完成后（单元格变为绿色），选择绿色下方的单元格输入公式（求和）

![](data:image/png;base64...)

步骤3.定义单元格，选择上一步中定义求和公式的单元格（D12），点击Define Forecast按钮（左三，红蓝柱状图图标），输入名称Name和单元格行列号Units。完成操作后，选中的单元格变为蓝色。

![](data:image/png;base64...)

步骤4. 点击Start按钮（绿色播放按钮），做出模拟图

![](data:image/png;base64...)

、

# 灵敏度分析

备注：灵敏度分析用于比较各个因素对结果的影响所占的比重，找出对结果影响最大的因素。

步骤1.在蒙托卡罗练习模拟图的基础上，选择图中菜单栏的Forecast→Open Sensitivity Chart选项

![](data:image/png;base64...)

步骤2.得到灵敏度分析结果图，如下：

![](data:image/png;base64...)

备注：灵敏度是看谁最重要（可用于原因分析使用、选择公共因子）

# 子过程模拟组合

备注：项目已定义过程用于预测各个子过程组合的结果，用来分析找出最优的组合方案。

步骤1.打开文件《项目已定义过程-水晶球练习》Sheet 3-量化过程选择

![](data:image/png;base64...)

步骤2.选择项目路径组合

![](data:image/png;base64...)

定义子过程正态分布输入项（绿色色块）

步骤3.在I18单元格输入公式，完成后进行定义

![](data:image/png;base64...)

步骤4.运行模拟，得到模拟图。在图下方位置，输入预测上限值（134），得出工期预测1的实现概率为87.58%

![](data:image/png;base64...)

步骤5.分析数据，得到结论

![](data:image/png;base64...)

结果分析过程：工期优先，兼顾质量。因为质量根据概率最高选择**模型5**，根据模型5（路径选择含有“规格”）推导工期工作量，在组合1或组合3中选择，考虑工期优先级最高，所以找工期最高的方案**组合3**。

步骤6.导出预测报表

选择菜单创建报表→预测报表

![](data:image/png;base64...)

导出报表

![1570614513(1)](data:image/png;base64...)

# 模型预测

1. 打开模板，表格内的最大值、最可能值、最小值是需要根据项目阶段的情况进行估算的值。模板内填写的为公司的整体水平数据。如果不能确定则可以保留模板数据。但部分数据是可根据项目计算的如：中级资源资源占比、代码复用度、平均业务能力（司龄）、配合紧密度，这些数据在策划阶段应根据项目情况进行填写，需结合项目测量表及分析表中的因子数据sheet一并填写。以平均业务能力为例：如果项目团队成员的平均司龄是3年，那么平均业务能力最可能值是3，然后根据项目情况判断是否有成员调入调出的风险，调入调出的人员司龄高低则会影响最大值及最小值，填写影响后的可能最大值、可能最小值，如果无法判断，则保留模板的原有最大最小值。

![IMG_256](data:image/png;base64...)

1. 点击“![IMG_256](data:image/png;base64...)”运行，会出现3个图，当前模板内的数值为公司目标的最大最小值，生产率预测变量图、项目进度偏差预测变量、故障密度预测变量分别填写生产率、项目进度、故障密度的项目目标值。
2. 填写数值后按“Enter”，确定输入数值。
3. 对结果进行截图，鼠标点击结果图，右键-》copy chart. 即可复制图片。

![](data:image/png;base64...)

![](data:image/png;base64...)

**策划阶段完成以上步骤即可，其他阶段再按照下面的步骤执行。**

详细的项目预测过程性能表的使用，需求阶段结束后需要进行如下操作：

1. 使用Crystal Ball的Clear功能，清除模板的绿色格子：G11、G12、G25、G26、G39、G40。（蓝色的格子可以不清除）截图如下：

![IMG_256](data:image/png;base64...)

1. 对因子进行假设定义。选中需要定义的格子，sigma有数字的表示该行的数据选择正态类型，没有数据的选择三角类型。正态定义步骤截图如下：

![IMG_256](data:image/png;base64...)

1. 定义假设内的均值与标准差的选择，截图如下：

![IMG_256](data:image/png;base64...)

1. 选好数据后，点击OK。如果成功，格子会变成绿色。截图如下：

![](data:image/png;base64...)

1. C26选择三角类型，步骤截图如下：

![IMG_256](data:image/png;base64...)

1. 三角型的数值直接填写最大值、最小值、最可能值，填写截图如下：

![IMG_256](data:image/png;base64...)

1. 填写完成后点击“OK”，设置成功，格子会变成绿色。
2. 设置完成后，蓝色格子可以不清除，点击运行后，填入项目目标值（如果策划阶段已经设置，此时该值不会改变，无需重新填写。）
3. 对结果进行截图。不同阶段的结果需存放在不同的sheet。
4. 每个阶段结束后需要根据项目的最新情况，评估项目的最大值、最小值、最可能值，标准差不变，然后重新运行一次截图。

![IMG_256](data:image/png;base64...)

# 过程稳定性分析

应用场景：基线数据分析、革新数据分析、项目度量数据统计表中用来监控数据异常点。

|  |
| --- |
| **会议评审方式** |
| 0.090837 |
| 0.063893 |
| 0.061669 |
| 0.066667 |
| 0.080483 |
| 0.079621 |
| 0.095906 |
| 0.032669 |
| 0.084453 |
| 0.067597 |
| 0.054811 |
| 0.06617 |
| 0.036364 |
| 0.082781 |
| 0.060273 |
| 0.087012 |
| 0.098747 |
| 0.057196 |
| 0.057011 |
| 0.059534 |
| 0.08 |
| 0.064858 |
| 0.056022 |

步骤1.将数据填入表格，在菜单栏中选择统计→控制图→单值变量的控制图→I-MR选项

![](data:image/png;base64...)

步骤2．将“会议评审方式”填入变量栏，单击I-MR选项按钮，选择检验栏，点击下拉菜单，选择执行所有的特殊原因检验，单击确定按钮

![](data:image/png;base64...)

步骤3．得出结论

![](data:image/x-emf;base64...)

没有异常点，有异常点图中会显示红色点。

备注：收集的样本数据应按时间顺序排列，以便分析过程是否稳定。合理抽样的目的是使抽取的样本具有代表性，能够捕捉过程的公共变异，但不包含特定变异

样本数据宜大于或等于25个，以便减少过程稳定性出错的风险

25个数据不能有1个异常

35个数据允许有1个异常

100个数据允许有2个异常

若有异常点，要对异常点进行分析，改进，消除异常点。

# Pareto图

应用场景：做原因分析时使用

革新（需求变更率、复用）原因分析和解决方案中使用了Pareto图。

说明：Pareto图用于统计原因出现频率，并以图形的形式呈现

![](data:image/png;base64...) 步骤1：将数据填入表格，选择菜单栏的统计→质量工Pareto图

|  |
| --- |
| **生产率低原因统计** |
| 软件开发工具故障 |
| 员工生病 |
| 病毒入侵电脑 |
| 设计输入不清晰 |
| 软件开发工具故障 |
| 软件开发工具故障 |
| 办公环境太拥挤 |
| 业务培训不充分 |
| 培训不充分 |
| 软件开发工具故障 |
| 开发流程不清晰 |
| 软件开发工具故障 |
| 员工生病 |
| 病毒入侵电脑 |
| 软件开发工具故障 |
| 设计输入不清晰 |
| 软件开发工具故障 |
| 软件开发工具故障 |
| 软件开发工具故障 |
| 病毒入侵电脑 |
| 软件开发工具故障 |
| 软件开发工具故障 |
| 软件开发工具故障 |
| 软件开发工具故障 |
| 病毒入侵电脑 |

步骤2.在缺陷或属性数据栏目填写“生产率低原因统计”，点击“确 定”按钮

![](data:image/png;base64...)

步骤3.结果呈现

![](data:image/png;base64...)

# 鱼骨图

应用场景：原因分析和模型建立时使用。

说明：鱼骨图用于根据待预测的结果，分析有哪些过程和属性与该结果有关。

步骤1.打开如下示例文件《讲解示例43 识别革新项 根本原因分析》

![](data:image/x-emf;base64...)

步骤2.在菜单栏中选择统计→质量工具→因果选项

![](data:image/png;base64...)

步骤3. 填写人/机器/材料/方法/环境的原因，还可以在分支所在行的右侧选择“子…”填写分支的子分支的原因

![](data:image/png;base64...)

![](data:image/png;base64...)

步骤4.出图

![](data:image/png;base64...)

# 回归分析

应用场景：模型和预测中使用。

说明：使用回归可以对连续变量 X 和连续变量 Y 之间的关系建模。

步骤1. 打开《项目量化管理练习数据2》的缺陷发现预测模型页签

![](data:image/x-emf;base64...)

练习数据如下：

|  |  |  |
| --- | --- | --- |
| **系统测试缺陷密度** | **测试人员经验** | **需求变更率** |
| 3.85 | 4.8 | 17.40% |
| 3.64 | 5.4 | 4.20% |
| 4 | 5.5 | 13.70% |
| 3.07 | 2.28 | 3.70% |
| 4.3 | 5.8 | 19.60% |
| 4.12 | 5.5 | 16.70% |
| 3.85 | 3.5 | 22.60% |
| 3.7 | 2.89 | 13.80% |
| 4.18 | 8 | 10.00% |
| 3.29 | 2.24 | 2.30% |
| 3.99 | 4.55 | 15.50% |
| 3.4 | 3.49 | 8.30% |
| 3.93 | 5.08 | 12.70% |
| 4 | 5.87 | 2.10% |
| 2.86 | 2.5 | 0.00% |
| 3.75 | 6.16 | 7.10% |
| 3.21 | 3.8 | 5.40% |
| 4.23 | 6.56 | 15.20% |
| 3.6 | 3.8 | 5.10% |
| 3.14 | 2.5 | 12.70% |

步骤2.在菜单栏中选择统计→回归→回归→拟合回归模型选项

备注：Minitab 16 中，菜单项选择统计→回归→回归选项

![](data:image/png;base64...)

步骤3. 填写线性回归中的响应（Y）和连续预测变量（X），单击“确认”按钮

![](data:image/png;base64...)

步骤4.得到回归方程，如下图：

![SpxImage3](data:image/png;base64...)

步骤5. 得到方程后，进行回归模型的预测

选择菜单栏中的统计→回归→回归→预测选项

备注：Minitab16中，选择统计→回归→回归→选项按钮

![](data:image/png;base64...)

步骤6. 输入预测结果：

变量 设置

测试人员经验 2.5

需求变更率 0.2

![](data:image/png;base64...)Minitab17

![](data:image/png;base64...)Minitab16

步骤7．观察结果

![SpxImage4](data:image/png;base64...)

观察预测区间是否落在质量目标范围内，如果在质量目标范围内，则正常。

以上图例的数据回归预测分析结果正常。

# 过程性能模型建立

![](data:image/x-emf;base64...) ![](data:image/x-emf;base64...)

步骤1.：建立因果图/鱼骨图，分析原因

![](data:image/png;base64...)

步骤2.：确定主要因素，建立模型（公式）

![](data:image/png;base64...)

步骤3.：度量数据

![](data:image/png;base64...)

步骤4.：相关性分析

备注：根据CORREL函数进行计算

根据散点图分析

![无标题](data:image/png;base64...)

从以下的相关的散点图中可以看出：

X1，X2与Y是线性相关的，并且每个相关的程度都是很高的。所以选择这两个自变量。

（备注：图从图形→散点图选项中得到）

![需求开发工作量Y 与 生命周期的影响力X1 的散点图.jpg](data:image/jpeg;base64...)

![需求开发工作量Y 与 需求稳定性X2 的散点图.jpg](data:image/jpeg;base64...)

步骤5：模型计算（利用MINITAB）

* 拟合优度检验

![](data:image/png;base64...)

（备注： MINITAB17 中，菜单栏中的统计→回归→回归→拟合回归模型）

* 方差分析

![](data:image/png;base64...)

* 回归方程

![](data:image/png;base64...)

（备注：MINITAB17 中，菜单栏中的统计→回归→回归→拟合回归模型）

步骤6：度量数据（预测值与实际值比较）

![](data:image/png;base64...)

![](data:image/x-emf;base64...)

注：需求开发工作量\*为模型预测值

步骤7：多重判定系数

![](data:image/png;base64...)

（备注：R2由拟合回归模型中的R-Sq（调整）得到）

步骤8：T检验

![](data:image/png;base64...)

![](data:image/png;base64...)

（备注：Ta/2由公式“=TINV(0.05,数据个数-X因子个数-1)”得到）

T1: 因子X1的T值

T2：因子X2的T值

步骤9：F检验

![](data:image/png;base64...)

![](data:image/png;base64...)

（备注：Fa由公式“=FINV(0.05,X因子个数,数据个数 –X因子个数-1)”计算得到

F由拟合回归模型中的F值得到）

# 方差分析示例（编码生产率分部门处理）

应用场景：革新时使用，判断革新前后数据是否存在显著差异。(P<0.05)

步骤1.打开MINITAB，将数据放入表格

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  | **开发一部** | **开发二部** | **开发三部** | **开发四部** |
| **项目1** | 1.2 | 1.1 | 0.7 | 0.8 |
| **项目2** | 1 | 1.2 | 0.9 | 0.9 |
| **项目3** | 0.8 | 0.7 | 1.4 | 1.3 |
| **项目4** | 0.9 | 0.9 | 1.5 | 1.2 |
| **项目5** | 1.1 | 1.3 | 0.6 | 1 |
| **项目6** | 1.4 | 0.8 | 1.5 | 0.9 |
| **项目7** | 1.5 | 1.4 | 1 |  |
| **项目8** | 0.8 | 0.9 |  |  |

步骤2.在菜单栏中选择统计→方差分析→单因子选项（大样本选择单因子Z，小样本选择单因子T）

备注：Minitab 16 中菜单选项为统计→方差分析→单因子（未堆叠存放）

![](data:image/png;base64...)

步骤3.选择每个因子水平的响应数据单独一列，将相应的因子填入响应中，单击“确定”按钮

备注：Minitab 16 中直接选择响应的因子即可。

![SpxImage1](data:image/png;base64...)

步骤4.方差分析

方差分析

来源 自由度 Adj SS Adj MS F 值 P 值

因子 3 0.02594 0.008647 0.11 0.954

误差 25 1.98440 0.079376

合计 28 2.01034

![](data:image/x-emf;base64...)

结果：观察P值，大于0.05所以可以一起分析

注：上图数据区间分布比较接近，也可以作为一起分析的参考。

# 编码效率练习-正态性检验

统计检测方法：AD检验

如果AD检验的值低于选定的显著性水平（通常为0.05），则可以得出结论：数据不服从指定分布；如果符合原假设，则AD值越大，表明分布对数据拟合度越好。

应用场景：做基线分析时，确定数据是不是正态分布的，只有符合正态分布的数据，才能进行基线分析。（P>0.05）

备注：当基于正态性假定进行统计分析时，如果怀疑总体分布的正态性，应进行正态性检验

练习数据：

|  |
| --- |
| **会议评审方式** |
| 0.090837 |
| 0.063893 |
| 0.061669 |
| 0.066667 |
| 0.080483 |
| 0.079621 |
| 0.095906 |
| 0.032669 |
| 0.084453 |
| 0.067597 |
| 0.054811 |
| 0.06617 |
| 0.036364 |
| 0.082781 |
| 0.060273 |
| 0.087012 |
| 0.098747 |
| 0.057196 |
| 0.057011 |
| 0.059534 |
| 0.08 |
| 0.064858 |
| 0.056022 |

![](data:image/png;base64...) 步骤1.将数据填入表格，在菜单栏中选择统计→基本统计量→正态性检验 选项

步骤2.将“会议评审方式”填入变量栏，单击确定按钮

![SpxImage2](data:image/png;base64...)

步骤3．得出结论

![无标题](data:image/png;base64...)

结果：正态检验P值大于0.05，所以数据是正态的。

# 控制图前后对比

主要用于原因分析解决以后或者革新前后对比：

|  |  |
| --- | --- |
| 2018验收测试缺陷数据 | 2019验收测试缺陷数据 |
| 0.067 | 0.0595238 |
| 0.064 | 0.0559441 |
| 0.057 | 0.0595238 |
| 0.058 | 0.0545455 |
| 0.075 | 0.0612245 |
| 0.06 | 0.0526316 |
| 0.064 | 0.0561224 |
| 0.054 | 0.0510949 |
| 0.067 | 0.062069 |
| 0.069 | 0.0559006 |
| 0.063 | 0.044586 |
| 0.07 | 0.0598802 |
| 0.075 | 0.0608108 |
| 0.056 | 0.0558659 |
| 0.065 | 0.0595238 |
| 0.06 | 0.0617978 |
| 0.072 | 0.0454545 |
| 0.065 | 0.057554 |
| 0.073 | 0.0555556 |
| 0.068 | 0.0661765 |
| 0.077 | 0.0608108 |
| 0.065 | 0.0558376 |
| 0.073 | 0.056962 |
| 0.07 | 0.0625 |
| 0.063 |  |
| 0.063 |  |
| 0.074 |  |
| 0.063 |  |
| 0.075 |  |
| 0.056 |  |
| 0.07 |  |
| 0.071 |  |
| 0.072 |  |
| 0.066 |  |
| 0.064 |  |
| 0.066 |  |
| 0.075 |  |
| 0.069 |  |
| 0.072 |  |
| 0.059 |  |
| 0.058 |  |
| 0.074 |  |
| 0.071 |  |
| 0.052 |  |
| 0.058 |  |
| 0.071 |  |
| 0.074 |  |
| 0.063 |  |
| 0.067 |  |
| 0.07 |  |
| 0.068 |  |
| 0.061 |  |
| 0.07 |  |
| 0.065 |  |
| 0.061 |  |
| 0.063 |  |
| 0.081 |  |
| 0.059 |  |
| 0.071 |  |
| 0.078 |  |
| 0.058 |  |
| 0.067 |  |
| 0.059 |  |
| 0.056 |  |
| 0.071 |  |

1.将革新前后数据进行堆叠，数据→堆叠→列

![](data:image/png;base64...)

2.统计→控制图→单值变量的控制图→单值

![](data:image/png;base64...)

3.输入变量，选择单值控制图选项→选择检验栏，点击下拉菜单，选择执行所有的特殊原因检验，单击确定按钮，点击阶段菜单，定义变量历史组（堆叠后数据）

![](data:image/png;base64...)

4.-点击确定，出图

![](data:image/x-emf;base64...)

此过程可清晰展示革新前后差异

# 箱线图绘制方法

|  |  |
| --- | --- |
| **改进前** | **改进后** |
| 2.3769 | 2.7730 |
| 2.4561 | 2.7304 |
| 1.7036 | 2.7257 |
| 2.5510 | 2.6132 |
| 2.4911 | 2.7586 |
| 2.3769 | 2.6178 |
| 2.4561 | 2.7027 |
| 2.4691 | 2.6178 |
| 2.3810 | 2.5862 |
| 2.4911 | 2.7304 |

图形-选择箱线图-选择左下角多个Y值，简单

![1603352840(1)](data:image/png;base64...)

在对话框中点击数据视图，在左侧选择均值符号以及均值连接线

![1603353170(1)](data:image/png;base64...)

![](data:image/x-emf;base64...)

# 能力指数-编码效率练习

应用场景：基线分析、革新数据分析时，判断能力是否达到目标。

|  |
| --- |
| **中级编码效率** |
| 2.45 |
| 3.33 |
| 3.72 |
| 3.02 |
| 2.43 |
| 2.62 |
| 3.67 |
| 2.24 |
| 1.46 |
| 3.48 |
| 3.04 |
| 1.96 |
| 2.27 |
| 2.61 |
| 2.99 |
| 1.41 |
| 2.96 |
| 3.78 |
| 3.62 |
| 2.33 |
| 4.5 |
| 1.8 |
| 2.21 |
| 2.24 |
| 1.96 |
| 1.48 |
| 1.9 |

![](data:image/png;base64...) 步骤1.将数据输入表格，在菜单栏中选择统计→质量工具→能力分析→正态选项

步骤2.选择单列选项填入“中级编码效率”，子组大小填入“1”，填入规格上限“5”和规格下限“0.5”，单击确定按钮

![](data:image/png;base64...)

步骤3.得出结论

![无标题1](data:image/png;base64...)

能力指数CPK 1.0—1.33说明公司能力满足客户要求，大于1.33说明能力大于客户要求，否则公司能力小于客户要求。上图中CPK能力显示分析数据还有待提升。

附：过程能力指数的评价标准

![](data:image/png;base64...)

# 过程绩效基线-编码效率练习

备注：基线是根据组织级项目的历史数据进行过程稳定性分析统计得到的，基线代表了组织的能力

**步骤：**

1．不同方式数据的方差分析

2．同一类的数据的正态分析

3．同一组数据的I-MR控制图